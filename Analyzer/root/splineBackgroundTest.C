#include <vector>

#include "TCanvas.h"
#include "TChain.h"
#include "TF1.h"
#include "TH1D.h"
#include "TSpline.h"


void printSpline(TSpline3* sp) {
  
  int fNp = sp->GetNp();
  double fXmin = sp->GetXmin(),fXmax = sp->GetXmax();

  std::vector<double> fX(fNp),fY(fNp),fB(fNp),fC(fNp),fD(fNp);

  for(int i = 0 ; i < fNp ; ++i) {
    sp->GetCoeff(i,fX[i],fY[i],fB[i],fC[i],fD[i]);
  }
  
  std::cout << fNp << "|" << fXmin << "|" << fXmax;
  for(int i = 0 ; i < fNp ; ++i) std::cout << "|" << fX[i];
  for(int i = 0 ; i < fNp ; ++i) std::cout << "|" << fY[i];
  for(int i = 0 ; i < fNp ; ++i) std::cout << "|" << fB[i];
  for(int i = 0 ; i < fNp ; ++i) std::cout << "|" << fC[i];
  for(int i = 0 ; i < fNp ; ++i) std::cout << "|" << fD[i];
  std::cout << '\n';
}

void splineBackgroundTest()
{
  TChain* eventTree = new TChain("analyzeKinFit/eventTree");
  //eventTree->Add("Run2012_Background_alljets.root");
  //eventTree->Add("Run2012_Mixing8_alljets.root");
  eventTree->Add("data/job_QCDMixing_MJPS12D*.root");
  
  TCanvas* canv = new TCanvas("canv","",600,600);  
  canv->SetMargin(0.15,0.05,0.15,0.05);
  //TH1D* wBkg = new TH1D("wBkg", ";m_{W}^{reco} [GeV];a.u.", 120, 65, 125); int rebin = 8; eventTree->Draw("(top.recoW1.M()+top.recoW2.M())/2.0>>wBkg","jet.jet[0].Pt() > 60 && jet.jet[1].Pt() > 60 && jet.jet[2].Pt() > 60 && jet.jet[3].Pt() > 60","norm");
  TH1D* wBkg = new TH1D("wBkg", ";m_{W}^{reco} [GeV];a.u.", 120, 65, 125); int rebin = 8; eventTree->Draw("(top.recoW1.M()+top.recoW2.M())/2.0>>wBkg","jet.jet[0].Pt() > 60 && jet.jet[1].Pt() > 60 && jet.jet[2].Pt() > 60 && jet.jet[3].Pt() > 60","norm");
  //TH1D* wBkg = new TH1D("wBkg", ";m_{t}^{fit} [GeV];a.u.", 120, 95, 215); int rebin = 8; eventTree->Draw("top.fitTop1.M()>>wBkg","jet.jet[0].Pt() > 60 && jet.jet[1].Pt() > 60 && jet.jet[2].Pt() > 60 && jet.jet[3].Pt() > 60","norm");
  //TH1D* wBkg = new TH1D("wBkg", ";m_{t}^{fit} [GeV];a.u.", 156, 91, 559); int rebin = 6; eventTree->Draw("top.fitTop1.M()>>wBkg","jet.jet[0].Pt() > 60 && jet.jet[1].Pt() > 60 && jet.jet[2].Pt() > 60 && jet.jet[3].Pt() > 60","norm");
  TH1D* wBkgTmp = (TH1D*)wBkg->Clone("wBkgTmp");
  wBkgTmp->Rebin(rebin);
  wBkg->Scale(rebin);
  TSpline3* s3 = new TSpline3(wBkgTmp);

  s3->SetLineWidth(2);
  s3->SetLineColor(kRed);

  wBkg->SetStats(0);
  wBkg->SetLineWidth(2);
  wBkg->SetLineColor(kBlack);
  wBkg->GetXaxis()->SetTitleSize(0.05);
  wBkg->GetYaxis()->SetTitleSize(0.05);
  wBkg->GetYaxis()->SetTitleOffset(1.2);

  wBkg->Draw();
  s3->Draw("PL same");
  s3->SaveAs("spline");
  printSpline(s3);
}


void makeSysSplines(TH1D* h, TF1* f, int ipar, double scale_up, double scale_down, int rebin = 8)
{
  static int cid = 0;
  TString cst="c";
  TCanvas* canv = new TCanvas(cst+=cid++,"",600,600);  
  canv->SetMargin(0.15,0.05,0.15,0.05);
   
  h->Sumw2();
  h->Scale(1/h->Integral());
  h->SetStats(0);
  h->SetLineWidth(2);
  h->SetLineColor(kBlack);
  h->GetXaxis()->SetTitleSize(0.05);
  h->GetYaxis()->SetTitleSize(0.05);
  h->GetYaxis()->SetTitleOffset(1.2);
  
  f->SetLineColor(kBlack);
  h->Fit(f);
  double par = f->GetParameter(ipar);

  TH1D* hRef = (TH1D*)h->Clone("hRef");

  TH1D* hUp = (TH1D*)h->Clone("hUp");
  hUp->SetLineColor(2);
  TH1D* hDown = (TH1D*)h->Clone("hDown");
  hDown->SetLineColor(3);
  hRef->Reset();
  hUp->Reset();
  hDown->Reset();

  hRef->Add(f);
  f->SetParameter(ipar,par*scale_up);
  hUp->Add(f);
  f->SetParameter(ipar,par*scale_down);
  hDown->Add(f);
  hUp->DrawCopy("same");
  hDown->DrawCopy("same");

  hRef->Rebin(rebin);
  hRef->Scale(1/hRef->Integral());
  hUp->Rebin(rebin);
  hUp->Scale(1/hUp->Integral());
  hDown->Rebin(rebin);
  hDown->Scale(1/hDown->Integral());
  

  TSpline3* s3ref = new TSpline3(hRef);
  TSpline3* s3up = new TSpline3(hUp);
  TSpline3* s3down = new TSpline3(hDown);

  cst="c";
  TCanvas* canv2= new TCanvas(cst+=cid++,"",600,600);
  canv2->SetMargin(0.15,0.05,0.15,0.05);
  hRef->Draw();
  hUp->Draw("same");
  hDown->Draw("same");

  
  s3ref->SetLineWidth(2);
  s3up->SetLineWidth(2);
  s3up->SetLineColor(2);
  s3down->SetLineWidth(2);
  s3down->SetLineColor(3);

  
  s3ref->Draw("PL same");
  s3up->Draw("PL same");
  s3down->Draw("PL same");
  //s3ref->SaveAs("sys_splineWref"); 
  //s3up->SaveAs("sys_splineWup"); 
  //s3down->SaveAs("sys_splineWdown");

  std::cout << "ref:\n";
  printSpline(s3ref);
  std::cout << "up:\n";
  printSpline(s3up);
  std::cout << "down:\n";
  printSpline(s3down);

  TString hst = h->GetName();
  hst+=1;
  hst+=".eps";
  canv->Print(hst);
  hst = h->GetName();
  hst+=2;
  hst+=".eps";
  canv2->Print(hst);


} 

void splineBackgroundTestSys()
{
  TChain* eventTree = new TChain("analyzeKinFit/eventTree");
  //eventTree->Add("Run2012_Background_alljets.root");
  //eventTree->Add("Run2012_Mixing8_alljets.root");
  eventTree->Add("data/job_QCDMixing_MJPS12D*.root");
  
  TH1D* wBkg = new TH1D("wBkg", ";m_{W}^{reco} [GeV];a.u.", 120, 65, 125); 
  eventTree->Draw("(top.recoW1.M()+top.recoW2.M())/2.0>>wBkg","jet.jet[0].Pt() > 60 && jet.jet[1].Pt() > 60 && jet.jet[2].Pt() > 60 && jet.jet[3].Pt() > 60","goff");
  
  TF1* ag = new TF1("ag", "[3]*(x<[0]?TMath::Gaus(x,[0],[1],0):TMath::Gaus(x,[0],[2],0))", 65, 125);
  ag->SetParameters(93.1875,8.05005,6.44822,0.1);
  std::cout << "W:\n";
  makeSysSplines(wBkg,ag,0,1.0134,0.9866,8);


  TH1D* tBkg = new TH1D("tBkg", ";m_{t}^{fit} [GeV];a.u.", 156, 91, 559); 
  eventTree->Draw("top.fitTop1.M()>>tBkg","jet.jet[0].Pt() > 60 && jet.jet[1].Pt() > 60 && jet.jet[2].Pt() > 60 && jet.jet[3].Pt() > 60","goff");
  
  TF1* gd = new TF1("gd", "[3]*TMath::GammaDist(x,[0],[1],[2])", 91, 559);
  gd->SetParameters(3.5,100,40);
  //ag->SetParameters(1.148*3.5,100,40);
  //ag->SetParameters(1.084*3.5,100,40);
  //ag->SetParameters(0.852*3.5,100,40);
  //ag->SetParameters(0.915*3.5,100,40);
  std::cout << "top:\n";
  makeSysSplines(tBkg,gd,0,1.084,0.915,6);
}


  ///////////
 /// old ///
///////////

// mW default
//15|67|123|67|71|75|79|83|87|91|95|99|103|107|111|115|119|123|0.0442538|0.191327|0.649141|1.72862|3.61331|5.92919|7.6383|7.57975|5.3128|2.56449|0.852202|0.194871|0.0306451|0.00331205|0.000245835|0.0243382|0.0624046|0.179709|0.371729|0.556503|0.552692|0.25147|-0.320655|-0.71297|-0.588913|-0.276829|-0.0809806|-0.0154158|-0.00102531|-0.00328238|-0.000194069|0.00971066|0.0196154|0.0283896|0.0178038|-0.0187564|-0.0565491|-0.0864824|-0.0115963|0.0426106|0.0354103|0.0135519|0.00283928|0.000758338|4|0.000825394|0.000825394|0.000731187|-0.000882149|-0.00304669|-0.00314939|-0.00249444|0.0062405|0.00451724|-0.000600024|-0.00182153|-0.00089272|-0.000173412|-0.000173412|1.85641

// mW up
//15|67|123|67|71|75|79|83|87|91|95|99|103|107|111|115|119|123|0.0266619|0.124334|0.454994|1.30678|2.94599|5.21354|7.24333|7.85451|6.17859|3.3508|1.25119|0.321538|0.0568372|0.00690634|0.000576466|0.0182638|0.0420569|0.134758|0.305745|0.510505|0.582306|0.38328|-0.134694|-0.643057|-0.67086|-0.36905|-0.124888|-0.0271678|-0.00241513|-0.00536727|-0.00133262|0.00728089|0.0158944|0.0268524|0.0243374|-0.00638708|-0.0433695|-0.0861238|-0.0409671|0.0340164|0.0414363|0.0196043|0.00482563|0.00136253|4|0.000717793|0.000717793|0.000913167|-0.000209584|-0.00256037|-0.00308187|-0.00356286|0.00376306|0.00624862|0.000618324|-0.00181933|-0.00123156|-0.000288592|-0.000288592|1.85641

// mW down
//15|67|123|67|71|75|79|83|87|91|95|99|103|107|111|115|119|123|0.0717375|0.287544|0.904522|2.2333|4.32848|6.58593|7.86387|7.06093|4.40526|1.89257|0.55968|0.113872|0.01593|0.00153123|0.00010106|0.0322529|0.0898742|0.232839|0.43809|0.58277|0.495299|0.0875765|-0.489353|-0.724122|-0.490434|-0.19833|-0.0502711|-0.00839866|-0.000389665|-0.00191437|0.00186869|0.0125366|0.0232046|0.0281082|0.00806186|-0.0299297|-0.072001|-0.0722315|0.0135394|0.0448826|0.0281435|0.00887113|0.00159698|0.000405268|4|0.000888994|0.000888994|0.000408639|-0.00167053|-0.00316596|-0.00350594|-1.92097e-05|0.00714758|0.00261193|-0.00139492|-0.00160603|-0.000606179|-9.93094e-05|-9.93094e-05|1.85641

// mT default
//15|99|215|99|107|115|123|131|139|147|155|163|171|179|187|195|203|215|4.35877e-05|0.000182871|0.000412635|0.000720674|0.00109511|0.00152483|0.00199957|0.00251|0.00304765|0.00360491|0.00417496|0.00475174|0.00532987|0.00590463|0.00647188|1.12451e-05|2.33206e-05|3.38649e-05|4.28956e-05|5.04824e-05|5.67328e-05|6.17586e-05|6.56722e-05|6.85819e-05|7.05909e-05|7.17958e-05|7.22873e-05|7.21471e-05|7.14591e-05|7.02695e-05|8.02571e-07|7.06869e-07|6.11168e-07|5.17659e-07|4.307e-07|3.50599e-07|2.77623e-07|2.11572e-07|1.52148e-07|9.89788e-08|5.1632e-08|9.79731e-09|-2.73204e-08|-5.86746e-08|8|-3.98755e-09|-3.98755e-09|-3.8962e-09|-3.62332e-09|-3.33752e-09|-3.04069e-09|-2.75211e-09|-2.47601e-09|-2.21538e-09|-1.97278e-09|-1.74311e-09|-1.54657e-09|-1.30642e-09|-1.30642e-09|3.71281

// mT up
//15|99|215|99|107|115|123|131|139|147|155|163|171|179|187|195|203|215|7.23769e-06|4.05536e-05|0.000109905|0.000218933|0.000368492|0.000557771|0.000784892|0.00104728|0.0013419|0.00166547|0.00201454|0.00238562|0.00277525|0.00318004|0.00359673|2.09091e-06|6.32738e-06|1.10997e-05|1.6166e-05|2.12064e-05|2.60726e-05|3.06532e-05|3.48795e-05|3.87075e-05|4.2112e-05|4.50819e-05|4.76161e-05|4.97208e-05|5.14103e-05|5.26945e-05|2.48032e-07|2.81526e-07|3.1502e-07|3.18263e-07|3.11783e-07|2.96492e-07|2.76084e-07|2.52209e-07|2.26284e-07|1.99285e-07|1.71943e-07|1.44833e-07|1.18263e-07|9.29259e-08|8|1.39557e-09|1.39557e-09|1.35152e-10|-2.7002e-10|-6.37118e-10|-8.50334e-10|-9.94804e-10|-1.08018e-09|-1.12498e-09|-1.13926e-09|-1.12955e-09|-1.10708e-09|-1.05573e-09|-1.05573e-09|3.71281

// mT down
//15|99|215|99|107|115|123|131|139|147|155|163|171|179|187|195|203|215|0.000246189|0.000765088|0.00143383|0.00219368|0.00300832|0.00385236|0.00470706|0.0055582|0.00639489|0.00720872|0.00799324|0.00874355|0.009456|0.010128|0.0107577|5.28268e-05|7.55629e-05|9.02887e-05|9.90055e-05|0.000104123|0.000106507|0.000106874|0.000105689|0.000103311|0.000100014|9.60147e-05|9.14873e-05|8.65702e-05|8.13869e-05|7.60009e-05|1.67133e-06|1.17068e-06|6.70042e-07|4.19559e-07|2.20138e-07|7.7847e-08|-3.20214e-08|-1.16113e-07|-1.81106e-07|-2.30993e-07|-2.6891e-07|-2.97023e-07|-3.17613e-07|-3.30291e-07|8|-2.08601e-08|-2.08601e-08|-1.04368e-08|-8.30919e-09|-5.92879e-09|-4.57785e-09|-3.50381e-09|-2.70805e-09|-2.07862e-09|-1.57988e-09|-1.17136e-09|-8.57942e-10|-5.2823e-10|-5.2823e-10|3.71281

  /////////////
 /// older ///
/////////////

// mW default
//15|67|123|67|71|75|79|83|87|91|95|99|103|107|111|115|119|123|0.0616377|0.255171|0.826481|2.09465|4.15446|6.44883|7.83426|7.32139|5.06908|2.58679|0.972782|0.269523|0.0550017|0.00826446|0.000914016|0.0297763|0.0812978|0.218665|0.423651|0.582717|0.511119|0.132655|-0.387319|-0.657261|-0.534589|-0.276605|-0.0969367|-0.0239835|-0.00307304|-0.0042901|0.00107483|0.0118055|0.0225362|0.0287104|0.011056|-0.0289555|-0.0656605|-0.064333|-0.00315254|0.0338204|0.0306756|0.0142415|0.00399678|0.00123084|4|0.000894225|0.000894225|0.000514512|-0.0014712|-0.00333429|-0.00305874|0.000110624|0.00509837|0.00308108|-0.00026207|-0.00136951|-0.000853728|-0.000230495|-0.000230495|1.85641

// mW up
//15|67|123|67|71|75|79|83|87|91|95|99|103|107|111|115|119|123|0.0378246|0.168921|0.590191|1.61346|3.45174|5.77921|7.5732|7.71137|5.8664|3.28947|1.35935|0.413897|0.0928315|0.0153321|0.00186406|0.0225005|0.0560469|0.167587|0.357013|0.55052|0.565216|0.279717|-0.234964|-0.619964|-0.601601|-0.353924|-0.139385|-0.0384224|-0.00584913|-0.00640671|-0.000681298|0.00906789|0.0188171|0.0285396|0.019837|-0.016163|-0.0552118|-0.0734583|-0.0227918|0.0273827|0.0345365|0.0190983|0.00614233|0.00200098|4|0.000812433|0.000812433|0.000810208|-0.000725212|-0.003|-0.00325406|-0.00152054|0.00422221|0.00418121|0.00059615|-0.00128651|-0.00107967|-0.000345113|-0.000345113|1.85641

// mW down
//15|67|123|67|71|75|79|83|87|91|95|99|103|107|111|115|119|123|0.098118|0.376542|1.13062|2.6565|4.88475|7.02986|7.90749|6.75192|4.25453|1.97584|0.67616|0.170465|0.0316505|0.00432648|0.000435251|0.0393919|0.114441|0.277217|0.48666|0.591746|0.426372|-0.0301774|-0.514114|-0.653088|-0.455591|-0.208324|-0.0651447|-0.0144793|-0.00154232|-0.00276288|0.0038983|0.0148641|0.0258299|0.0265308|-0.000259124|-0.0410845|-0.0730528|-0.0479315|0.013188|0.0361861|0.0256306|0.0101644|0.00250196|0.000732273|4|0.000913815|0.000913815|5.84104e-05|-0.00223249|-0.00340212|-0.00266402|0.00209344|0.00509329|0.00191651|-0.000879633|-0.00128885|-0.000638537|-0.000147474|-0.000147474|1.85641

// mT default
//26|100|550|100|118|136|154|172|190|208|226|244|262|280|298|316|334|352|370|388|406|424|442|460|478|496|514|532|550|1.50966e-05|0.00103497|0.00516938|0.0117925|0.0189103|0.0248794|0.0288469|0.0306419|0.0305225|0.0289453|0.026405|0.0233429|0.0201074|0.0169471|0.014021|0.011416|0.00916641|0.00727061|0.00570474|0.00443305|0.0034151|0.00261039|0.00198118|0.00149395|0.0011199|0.000834953|-3.44141e-05|0.000145454|0.000311646|0.000400891|0.000374946|0.000280477|0.000159249|4.29326e-05|-5.17214e-05|-0.000118803|-0.000159313|-0.000177691|-0.000179521|-0.000170177|-0.000154177|-0.000134975|-0.000115012|-9.58686e-05|-7.84594e-05|-6.32207e-05|-5.02642e-05|-3.94998e-05|-3.07225e-05|-2.36833e-05|-1.80917e-05|-1.37826e-05|5.18628e-06|4.80638e-06|4.42649e-06|5.31617e-07|-1.97304e-06|-3.27521e-06|-3.45969e-06|-3.00232e-06|-2.25623e-06|-1.47054e-06|-7.79992e-07|-2.41021e-07|1.39345e-07|3.79767e-07|5.09168e-07|5.57572e-07|5.51475e-07|5.12073e-07|4.55103e-07|3.91492e-07|3.28316e-07|2.69702e-07|2.1793e-07|1.73134e-07|1.3751e-07|18|-7.03508e-09|-7.03508e-09|-7.21273e-08|-4.63826e-08|-2.41142e-08|-3.41636e-09|8.46983e-09|1.38165e-08|1.45498e-08|1.2788e-08|9.98094e-09|7.04381e-09|4.45225e-09|2.39632e-09|8.96361e-10|-1.12896e-10|-7.29673e-10|-1.055e-09|-1.17799e-09|-1.16991e-09|-1.08546e-09|-9.58734e-10|-8.29552e-10|-6.5971e-10|-6.5971e-10|8.35383

// mT up
//26|100|550|100|118|136|154|172|190|208|226|244|262|280|298|316|334|352|370|388|406|424|442|460|478|496|514|532|550|2.15072e-06|0.000293057|0.00207092|0.00595541|0.0113222|0.0170297|0.0220435|0.025708|0.0277711|0.0282918|0.0275182|0.025781|0.0234168|0.0207232|0.0179375|0.0152324|0.0127218|0.0104708|0.00850717|0.00683244|0.00543083|0.00427656|0.00333918|0.00258719|0.00199044|0.00152142|-8.19291e-06|4.89908e-05|0.000157025|0.000266636|0.000318308|0.000305849|0.000245179|0.000159813|7.01665e-05|-9.8454e-06|-7.29255e-05|-0.000116913|-0.000142987|-0.000154101|-0.000153837|-0.000145691|-0.00013268|-0.000117193|-0.000100986|-8.52522e-05|-7.07296e-05|-5.78102e-05|-4.66379e-05|-3.71991e-05|-2.93561e-05|-2.30059e-05|8.82184e-07|2.29469e-06|3.70719e-06|2.38234e-06|4.88295e-07|-1.18041e-06|-2.19019e-06|-2.55233e-06|-2.42805e-06|-2.01706e-06|-1.48739e-06|-9.56363e-07|-4.92209e-07|-1.25197e-07|1.39836e-07|3.12729e-07|4.10114e-07|4.50263e-07|4.50133e-07|4.23959e-07|3.82851e-07|3.34894e-07|2.85787e-07|2.38594e-07|1.97128e-07|18|2.61575e-08|2.61575e-08|-2.45343e-08|-3.50748e-08|-3.0902e-08|-1.86995e-08|-6.7064e-09|2.30154e-09|7.6109e-09|9.80869e-09|9.83384e-09|8.59544e-09|6.79652e-09|4.90801e-09|3.20173e-09|1.80343e-09|7.43492e-10|-2.39957e-12|-4.84704e-10|-7.61269e-10|-8.88097e-10|-9.09389e-10|-8.73937e-10|-7.67896e-10|-7.67896e-10|8.35383

// mT down
//26|100|550|100|118|136|154|172|190|208|226|244|262|280|298|316|334|352|370|388|406|424|442|460|478|496|514|532|550|9.75514e-05|0.00336093|0.011726|0.0211436|0.028559|0.0328445|0.0340996|0.0329835|0.0302913|0.0267378|0.0228744|0.0190802|0.0155862|0.0125106|0.00989298|0.00772294|0.00596167|0.00455696|0.00345297|0.00259616|0.00193838|0.00143817|0.00106097|0.000778635|0.00056872|0.000413584|-3.81589e-05|0.000361884|0.000528696|0.000487112|0.000328355|0.00014961|-3.36368e-06|-0.000112982|-0.000179414|-0.000210315|-0.000215485|-0.000204009|-0.000183169|-0.000158243|-0.000132735|-0.000108763|-8.74319e-05|-6.91731e-05|-5.39924e-05|-4.1656e-05|-3.18147e-05|-2.40835e-05|-1.80869e-05|-1.34922e-05|-9.98606e-06|-7.40546e-06|1.43516e-05|7.87298e-06|1.39433e-06|-3.70454e-06|-5.1153e-06|-4.81499e-06|-3.68354e-06|-2.40639e-06|-1.28423e-06|-4.32508e-07|1.45291e-07|4.92237e-07|6.65537e-07|7.19287e-07|6.97777e-07|6.34046e-07|5.50991e-07|4.63386e-07|3.79987e-07|3.05368e-07|2.41375e-07|1.88133e-07|1.45015e-07|1.10246e-07|8.45376e-08|18|-1.19975e-07|-1.19975e-07|-9.44235e-08|-2.61253e-08|5.56136e-09|2.09528e-08|2.36508e-08|2.07808e-08|1.57726e-08|1.07e-08|6.42492e-09|3.20926e-09|9.95368e-10|-3.98333e-10|-1.18021e-09|-1.53805e-09|-1.62232e-09|-1.54442e-09|-1.38184e-09|-1.18504e-09|-9.85981e-10|-7.98482e-10|-6.4386e-10|-4.76084e-10|-4.76084e-10|8.35383

  //////////////////////
 /// older RunB fix ///
//////////////////////

// mW default
//15|67|123|67|71|75|79|83|87|91|95|99|103|107|111|115|119|123|0.118297|0.402812|1.11117|2.48336|4.49683|6.59784|7.84284|7.21532|4.6117|2.01502|0.60164|0.122689|0.0170766|0.00162111|0.000104882|0.0413882|0.112489|0.253309|0.434683|0.547203|0.462364|0.112854|-0.450667|-0.73354|-0.515402|-0.212399|-0.0542467|-0.00903698|-0.00040611|-0.00206735|0.0045302|0.0132451|0.0219599|0.0233834|0.00474674|-0.0259566|-0.0614209|-0.0794593|0.0087412|0.0457931|0.0299577|0.00958031|0.00172212|0.000435602|4|0.000726239|0.000726239|0.000118623|-0.00155306|-0.00255861|-0.00295536|-0.0015032|0.00735004|0.00308766|-0.00131962|-0.00169812|-0.00065485|-0.00010721|-0.00010721|1.85641

// mW up
//15|67|123|67|71|75|79|83|87|91|95|99|103|107|111|115|119|123|0.0776139|0.282066|0.830424|1.9807|3.82772|5.99353|7.60439|7.67303|5.51566|2.71082|0.910554|0.208928|0.0327272|0.00349731|0.000254768|0.0312198|0.0825539|0.203172|0.378736|0.529855|0.511466|0.256786|-0.278984|-0.707398|-0.613083|-0.294099|-0.0869393|-0.0165134|-0.00108029|-0.00351976|0.0020865|0.010747|0.0194075|0.0244833|0.0132965|-0.0178936|-0.0457765|-0.0881658|-0.0189377|0.0425163|0.0372297|0.0145603|0.00304618|0.000812105|4|0.00072171|0.00072171|0.000422981|-0.000932238|-0.00259918|-0.00232357|-0.00353244|0.00576901|0.00512116|-0.000440546|-0.00188912|-0.000959509|-0.000186173|-0.000186173|1.85641

// mW down
//15|67|123|67|71|75|79|83|87|91|95|99|103|107|111|115|119|123|0.17671|0.563784|1.45721|3.05157|5.17772|7.11849|7.90373|6.54317|3.71823|1.44428|0.383301|0.0694636|0.0085903|0.000724388|4.16209e-05|0.054785|0.149407|0.307963|0.484582|0.544093|0.389237|-0.0565351|-0.594587|-0.704243|-0.41261|-0.146514|-0.0324433|-0.0047458|-0.000127869|-0.00115423|0.00783197|0.0158236|0.0238152|0.0203397|-0.00546208|-0.0332518|-0.0781912|-0.0563219|0.0289079|0.0440006|0.0225233|0.00599437|0.00093001|0.000224473|4|0.000665969|0.000665969|-0.000289629|-0.00215015|-0.00231581|-0.00374495|0.00182244|0.00710248|0.00125772|-0.00178977|-0.00137741|-0.00042203|-5.87947e-05|-5.87947e-05|1.85641

// mT default
//26|100|550|100|118|136|154|172|190|208|226|244|262|280|298|316|334|352|370|388|406|424|442|460|478|496|514|532|550|0.000125446|0.00417778|0.0141114|0.0246471|0.032267|0.0359826|0.0362348|0.0340029|0.0303008|0.025956|0.0215518|0.0174493|0.0138366|0.0107817|0.00827716|0.00627338|0.00470187|0.00348961|0.00256748|0.00187444|0.00135899|0.000979122|0.000701431|0.000499898|0.000354584|0.000250418|-4.18381e-05|0.000440298|0.000611638|0.000524707|0.000315474|0.000102644|-6.47645e-05|-0.000173538|-0.000230071|-0.000247337|-0.000238755|-0.00021542|-0.00018543|-0.000154122|-0.000124657|-9.86412e-05|-7.666e-05|-5.86819e-05|-4.43436e-05|-3.31371e-05|-2.45226e-05|-1.79927e-05|-1.31002e-05|-9.47702e-06|-6.79952e-06|-4.90499e-06|1.77093e-05|9.07606e-06|4.42843e-07|-5.27233e-06|-6.35172e-06|-5.47217e-06|-3.82832e-06|-2.21465e-06|-9.26062e-07|-3.32056e-08|5.10023e-07|7.86365e-07|8.79734e-07|8.59594e-07|7.77362e-07|6.67955e-07|5.53222e-07|4.45562e-07|3.51005e-07|2.71579e-07|2.07006e-07|1.55767e-07|1.16038e-07|8.52497e-08|6.35004e-08|18|-1.59874e-07|-1.59874e-07|-1.05837e-07|-1.99886e-08|1.62879e-08|3.04416e-08|2.98829e-08|2.38627e-08|1.65344e-08|1.00598e-08|5.11745e-09|1.72907e-09|-3.72975e-10|-1.52281e-09|-2.02607e-09|-2.12467e-09|-1.99371e-09|-1.75106e-09|-1.47086e-09|-1.19579e-09|-9.48865e-10|-7.35725e-10|-5.70155e-10|-4.02765e-10|-4.02765e-10|8.35383

// mT up
//26|100|550|100|118|136|154|172|190|208|226|244|262|280|298|316|334|352|370|388|406|424|442|460|478|496|514|532|550|5.26245e-05|0.00244249|0.00982733|0.0192371|0.0273635|0.0325634|0.0345879|0.0339581|0.0314709|0.0279075|0.0239012|0.0199016|0.0161903|0.0129164|0.0101345|0.00783865|0.00598767|0.00452389|0.00338491|0.00251086|0.00184809|0.00135076|0.000981006|0.000708353|0.000508776|0.000363655|-5.75192e-05|0.00029729|0.000497477|0.000511897|0.000377637|0.000198602|3.20138e-05|-9.41949e-05|-0.000174738|-0.000215285|-0.000225728|-0.000216126|-0.00019492|-0.000168395|-0.000140796|-0.00011471|-9.15064e-05|-7.17245e-05|-5.53879e-05|-4.22279e-05|-3.18379e-05|-2.37707e-05|-1.75931e-05|-1.29248e-05|-9.41268e-06|-6.87409e-06|1.20033e-05|7.70828e-06|3.41325e-06|-2.61215e-06|-4.84673e-06|-5.09969e-06|-4.15518e-06|-2.85642e-06|-1.61818e-06|-6.34467e-07|5.4303e-08|4.79165e-07|6.98928e-07|7.7467e-07|7.58613e-07|6.90593e-07|5.98522e-07|5.00472e-07|4.07121e-07|3.23987e-07|2.53236e-07|1.9494e-07|1.48264e-07|1.11082e-07|8.40382e-08|18|-7.95378e-08|-7.95378e-08|-1.11581e-07|-4.13812e-08|-4.68449e-09|1.7491e-08|2.40512e-08|2.29303e-08|1.82169e-08|1.2755e-08|7.86781e-09|4.06968e-09|1.40264e-09|-2.97344e-10|-1.25964e-09|-1.70501e-09|-1.81575e-09|-1.72871e-09|-1.53951e-09|-1.3102e-09|-1.07956e-09|-8.6438e-10|-6.8855e-10|-5.00809e-10|-5.00809e-10|8.35383

// mT down
//26|100|550|100|118|136|154|172|190|208|226|244|262|280|298|316|334|352|370|388|406|424|442|460|478|496|514|532|550|0.000295562|0.00702222|0.0197999|0.030787|0.0370462|0.0386766|0.0368982|0.0330758|0.0283273|0.0234298|0.0188536|0.0148377|0.0114648|0.00872312|0.00655058|0.00486381|0.003576|0.00260652|0.00188538|0.00135448|0.000967123|0.000686737|0.000485201|0.000341248|0.000239003|0.000166751|3.97182e-05|0.000624738|0.000712059|0.000487814|0.000211053|-1.70829e-05|-0.000167378|-0.000246872|-0.00027362|-0.000266319|-0.000240051|-0.000205493|-0.00016945|-0.000135796|-0.000106395|-8.18417e-05|-6.2001e-05|-4.63682e-05|-3.42956e-05|-2.51241e-05|-1.82512e-05|-1.31606e-05|-9.42647e-06|-6.71509e-06|-4.74629e-06|-3.38245e-06|2.31631e-05|9.33807e-06|-4.48692e-06|-7.97114e-06|-7.4045e-06|-5.26969e-06|-3.08007e-06|-1.33623e-06|-1.49805e-07|5.55423e-07|9.03943e-07|1.01592e-06|9.86467e-07|8.83203e-07|7.50202e-07|6.13869e-07|4.88393e-07|3.80099e-07|2.906e-07|2.18925e-07|1.62901e-07|1.19912e-07|8.75414e-08|6.30908e-08|4.62866e-08|18|-2.56018e-07|-2.56018e-07|-6.45225e-08|1.04932e-08|3.95337e-08|4.05485e-08|3.22932e-08|2.19709e-08|1.30598e-08|6.45408e-09|2.07358e-09|-5.45362e-10|-1.91229e-09|-2.46297e-09|-2.52469e-09|-2.32363e-09|-2.00544e-09|-1.6574e-09|-1.32731e-09|-1.03749e-09|-7.96098e-10|-5.99448e-10|-4.52789e-10|-3.11189e-10|-3.11189e-10|8.35383
